
# app = Application().connect(title='KeePass')
import pywinauto
from pywinauto import Application
import psutil
from PIL import ImageGrab
import time


def get_keepass_pid():
    for process in psutil.process_iter(attrs=['pid', 'name']):
        if process.info['name'] == 'KeePass.exe':
            return process.info['pid']
    return None

def find_window_info_by_process_name(process_name):
    app = pywinauto.application.Application().connect(process=get_keepass_pid())
    return app.top_window()

name = "KeePass"
find_window_info_by_process_name("")

target_window1 = find_window_info_by_process_name(name)
# Send Ctrl+P or other interactions here
target_window1.type_keys('^p')
time.sleep(0.5)
# Capture the entire screen
screenshot = ImageGrab.grab()

# Save the screenshot to a file
screenshot.save("screenshot.png")

# Show the screenshot (optional)
#screenshot.show()
target_window2 = find_window_info_by_process_name(name)
target_window2.type_keys('%{F4}')